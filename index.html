<!DOCTYPE html>
<html>
<head>
    <title>Google Docs</title>
    <style>
        :root { --bg: #020617; --card: #0f172a; --accent: #3b82f6; --text: #f8fafc; }
        body { background: var(--bg); color: var(--text); font-family: 'Segoe UI', sans-serif; margin: 0; background-size: cover; background-position: center; background-attachment: fixed; overflow-x: hidden; }
        
        /* Maintenance Overlay */
        #maintScreen { position: fixed; inset: 0; background: #000; z-index: 100000; display: none; flex-direction: column; align-items: center; justify-content: center; text-align: center; }
        
        /* Auth Screen */
        .auth-screen { position: fixed; inset: 0; background: #000; z-index: 50000; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .patch-notes { margin-top: 30px; background: #0f172a; padding: 15px; border-radius: 12px; border: 1px solid #1e293b; width: 300px; font-size: 0.85rem; }
        
        /* Layout */
        .navbar { background: rgba(15, 23, 42, 0.9); backdrop-filter: blur(10px); padding: 15px 30px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #1e293b; position: sticky; top: 0; z-index: 1000; }
        .container { padding: 30px; max-width: 1400px; margin: 0 auto; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 20px; margin-bottom: 40px; }
        .game-card { background: var(--card); border-radius: 15px; padding: 20px; text-align: center; cursor: pointer; border: 1px solid #1e293b; transition: 0.3s; position: relative; }
        .game-card:hover { border-color: var(--accent); transform: translateY(-3px); box-shadow: 0 10px 20px rgba(0,0,0,0.5); }
        .fav-star { position: absolute; top: 8px; right: 8px; cursor: pointer; color: rgba(255,255,255,0.2); font-size: 20px; }
        .fav-star.active { color: #fbbf24; }

        /* UI Elements */
        .btn { padding: 12px 20px; border-radius: 8px; border: none; cursor: pointer; font-weight: bold; color: white; background: var(--accent); margin: 5px; text-decoration: none; }
        .btn-panic { background: #ef4444; }
        #gameView { position: fixed; inset: 0; background: #000; z-index: 30000; display: none; flex-direction: column; }
        iframe { flex-grow: 1; border: none; background: #fff; }
        #launchModal { position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 20000; display: none; align-items: center; justify-content: center; }
        .launch-box { background: #0f172a; padding: 30px; border-radius: 20px; border: 2px solid var(--accent); text-align: center; width: 320px; }
        .section-header { color: var(--accent); border-left: 4px solid var(--accent); padding-left: 12px; margin: 40px 0 20px; }
        #adminLink { display: none; position: fixed; bottom: 20px; right: 20px; background: #ef4444; padding: 12px; border-radius: 10px; color: white; font-weight: bold; text-decoration: none; }
    </style>
</head>
<body>

    <div id="maintScreen">
        <h1 style="color:#ef4444; font-size: 3rem;">‚ö†Ô∏è SITE UNDER MAINTENANCE</h1>
        <p style="color:#94a3b8;">We are currently updating the arcade. Please check back later!</p>
        <div style="margin-top:40px;">
            <input type="password" id="maintPass" placeholder="Bypass Password..." style="padding:10px; background:#111; border:1px solid #333; color:white; border-radius:8px;">
            <button class="btn" onclick="bypassMaint()">Unlock</button>
        </div>
    </div>

    <div id="authScreen" class="auth-screen">
        <h1 style="color:var(--accent); font-size: 4rem; margin:0;">MONGLE</h1>
        <div id="loginStep1">
            <input type="text" id="userInput" placeholder="Username..." style="padding:15px; width:280px; background:#111; color:white; border:1px solid #333; border-radius:10px;">
            <br><button class="btn" style="width:310px; margin-top:10px;" onclick="handleUser()">Sign In</button>
        </div>
        <div id="loginStep2" style="display:none;">
            <input type="password" id="passInput" placeholder="Password..." style="padding:15px; width:280px; background:#111; color:white; border:1px solid #333; border-radius:10px;">
            <br><button class="btn" style="width:310px; margin-top:10px;" onclick="verifyAdmin()">Verify Admin</button>
        </div>
        <div class="patch-notes">
            <h4 style="margin:0; color:var(--accent);">v5.5 UPDATES</h4>
            <ul style="padding-left:18px; margin:10px 0; color:#94a3b8;">
                <li>Added Admin Maintenance Mode</li>
                <li>Fixed Favorites & Last Played Logic</li>
                <li>Global Emoji System Restored</li>
                <li>Bypassed GitHub Connection Error</li>
            </ul>
        </div>
    </div>

    <div class="navbar">
        <div id="clock" style="color:#4ade80; font-family: monospace; font-weight:bold;">00:00:00</div>
        <div style="display:flex; align-items:center; gap:10px;">
            <input type="text" id="search" placeholder="Search..." onkeyup="search()" style="padding:10px; background:#000; color:white; border:1px solid #333; border-radius:10px;">
            <a href="wiki.html" class="btn" style="background:#334155;">Settings</a>
            <button class="btn btn-panic" onclick="panic()">Panic</button>
        </div>
    </div>

    <div id="arcade" class="container">
        <div id="favSec" style="display:none;"><h2 style="color:#fbbf24">‚≠ê Favorites</h2><div id="favGrid" class="grid"></div></div>
        <div id="recentSec" style="display:none;"><h2 style="color:#a855f7">üïí Last Played</h2><div id="recentGrid" class="grid"></div></div>
        <div id="fnafSec" style="display:none;"><h2 class="section-header">üêª FNAF Collection</h2><div id="fnafGrid" class="grid"></div></div>
        <h2 class="section-header">üïπÔ∏è Game Library</h2>
        <div id="mainGrid" class="grid"></div>
    </div>

    <div id="launchModal">
        <div class="launch-box">
            <h2 id="ltitle" style="color:var(--accent); margin-top:0;">Game</h2>
            <button class="btn" style="width:90%" onclick="launch('normal')">Save in Web (Normal)</button>
            <button class="btn" style="width:90%; background:#6366f1;" onclick="launch('stealth')">No Save (About:Blank)</button>
            <br><button class="btn" style="background:none; color:#444;" onclick="closeModal()">Cancel</button>
        </div>
    </div>

    <div id="gameView">
        <div style="background:#000; padding:10px; display:flex; justify-content:space-between;">
            <button class="btn" onclick="exitGame()" style="background:#334155;">‚Üê Back</button>
            <button class="btn btn-panic" onclick="panic()">PANIC</button>
        </div>
        <iframe id="gameFrame"></iframe>
    </div>

    <a href="wiki.html?mode=admin" id="adminLink">üõ°Ô∏è ADMIN</a>

    <script>
        const REPO = { user: "bob154526-hue", name: "Mongle", pass: "1234" };
        let activeUrl = "", activeName = "";

        // MAINTENANCE CHECK
        if(localStorage.getItem('maintenanceMode') === 'true' && !sessionStorage.getItem('mBypass')) {
            document.getElementById('maintScreen').style.display = 'flex';
        }
        function bypassMaint() {
            if(document.getElementById('maintPass').value === REPO.pass) {
                sessionStorage.setItem('mBypass', 'true');
                location.reload();
            } else { alert("Wrong bypass password."); }
        }

        // Apply Custom Theme
        const bg = localStorage.getItem('mBG');
        if(bg) {
            document.body.style.backgroundImage = bg.includes('http') ? `url(${bg})` : 'none';
            if(!bg.includes('http')) document.body.style.backgroundColor = bg;
        }

        // Panic Shortcut
        window.addEventListener('keydown', (e) => { if(e.key === (localStorage.getItem('mPanicKey') || 'Escape')) panic(); });

        // Auth
        if(sessionStorage.getItem('mAuth')) document.getElementById('authScreen').style.display='none';
        function handleUser() {
            let n = document.getElementById('userInput').value.trim().toLowerCase();
            if(n === 'mongle') { document.getElementById('loginStep1').style.display='none'; document.getElementById('loginStep2').style.display='block'; }
            else if(n) { sessionStorage.setItem('mAuth', n); location.reload(); }
        }
        function verifyAdmin() {
            if(document.getElementById('passInput').value === REPO.pass) { sessionStorage.setItem('mAuth','mongle'); location.reload(); }
            else alert("Denied");
        }

        // Loader
        async function load() {
            const res = await fetch(`https://api.github.com/repos/${REPO.user}/${REPO.name}/contents/`);
            const files = await res.json();
            const favs = JSON.parse(localStorage.getItem('mFavs')) || [];
            const last = localStorage.getItem('mLast');
            const emoji = localStorage.getItem('mEmoji') || "üéÆ";

            files.forEach(file => {
                if(!file.name.endsWith('.html') || ['index.html','wiki.html'].includes(file.name)) return;
                const name = file.name.replace('.html','');
                const isFav = favs.includes(file.name);
                const card = document.createElement('div');
                card.className = 'game-card';
                card.innerHTML = `<span class="fav-star ${isFav?'active':''}" onclick="toggleFav(event,'${file.name}')">‚òÖ</span>
                                  <div onclick="openMenu('${file.download_url}','${name}')"><div style="font-size:40px">${emoji}</div><b>${name}</b></div>`;
                
                if(isFav) { document.getElementById('favSec').style.display='block'; document.getElementById('favGrid').appendChild(card.cloneNode(true)); document.getElementById('favGrid').lastChild.onclick=()=>openMenu(file.download_url, name); }
                if(name === last) { document.getElementById('recentSec').style.display='block'; document.getElementById('recentGrid').appendChild(card.cloneNode(true)); document.getElementById('recentGrid').lastChild.onclick=()=>openMenu(file.download_url, name); }
                if(name.toLowerCase().match(/fnaf|freddy/)) { document.getElementById('fnafSec').style.display='block'; document.getElementById('fnafGrid').appendChild(card); }
                else { document.getElementById('mainGrid').appendChild(card); }
            });
        }

        function openMenu(url, name) { activeUrl=url; activeName=name; document.getElementById('ltitle').innerText=name; document.getElementById('launchModal').style.display='flex'; }
        function closeModal() { document.getElementById('launchModal').style.display='none'; }
        async function launch(mode) {
            localStorage.setItem('mLast', activeName);
            const res = await fetch(activeUrl);
            const html = await res.text();
            if(mode === 'normal') {
                document.getElementById('launchModal').style.display='none';
                document.getElementById('gameView').style.display='flex';
                document.getElementById('gameFrame').srcdoc = html;
            } else {
                const win = window.open('about:blank', '_blank');
                win.document.write(`<title>${activeName}</title><body style="margin:0;"><iframe srcdoc="${html.replace(/"/g, '&quot;')}" style="width:100vw;height:100vh;border:none;"></iframe></body>`);
                window.location.replace('https://google.com');
            }
        }

        function toggleFav(e, f) { e.stopPropagation(); let favs = JSON.parse(localStorage.getItem('mFavs')) || []; favs = favs.includes(f) ? favs.filter(x=>x!==f) : [...favs,f]; localStorage.setItem('mFavs', JSON.stringify(favs)); location.reload(); }
        function search() { let q = document.getElementById('search').value.toLowerCase(); if(q === 'admin' && sessionStorage.getItem('mAuth') === 'mongle') document.getElementById('adminLink').style.display='block'; document.querySelectorAll('.game-card').forEach(c => c.style.display = c.innerText.toLowerCase().includes(q) ? 'block' : 'none'); }
        function panic() { window.location.replace(localStorage.getItem('mPanicUrl') || 'https://classroom.google.com'); }
        function exitGame() { document.getElementById('gameView').style.display='none'; document.getElementById('gameFrame').srcdoc=""; }
        setInterval(() => { document.getElementById('clock').innerText = new Date().toLocaleTimeString(); }, 1000);
        load();
    </script>
</body>
</html>
