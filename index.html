<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Google Drive</title>
    <link id="favicon" rel="icon" href="https://ssl.gstatic.com/images/branding/product/1x/drive_2020q4_32dp.png">
    <style>
        :root { --primary: #00ff41; --bg: #000500; --card: rgba(10, 10, 10, 0.95); --accent: #003b00; --gold: #ffd700; }
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; background: var(--bg); color: var(--primary); font-family: 'Courier New', monospace; overflow: hidden; }

        /* SCROLLBAR */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #000; }
        ::-webkit-scrollbar-thumb { background: var(--accent); border-radius: 10px; }

        /* GRID & HEADERS */
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 20px; padding: 30px; height: calc(100vh - 100px); overflow-y: auto; align-content: start; }
        
        .category-header { 
            grid-column: 1 / -1; 
            color: var(--gold); 
            border-bottom: 2px solid var(--gold); 
            margin: 30px 0 10px 0; 
            padding-bottom: 5px; 
            font-size: 22px; 
            font-weight: bold;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
            text-transform: uppercase;
        }
        .category-header:first-child { margin-top: 0; }

        /* GAME CARDS */
        .game-card { 
            background: var(--card); 
            border: 1px solid var(--accent); 
            border-radius: 12px; 
            padding: 15px; 
            text-align: center; 
            cursor: pointer; 
            transition: 0.3s; 
            position: relative;
            overflow: hidden;
        }
        .game-card:hover { border-color: var(--primary); transform: translateY(-5px); box-shadow: 0 0 20px rgba(0, 255, 65, 0.2); }
        
        .game-icon { width: 100%; aspect-ratio: 1; border-radius: 8px; object-fit: cover; margin-bottom: 12px; background: #111; border: 1px solid #222; }
        
        .fav-star {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 20px;
            color: #333;
            transition: 0.2s;
            z-index: 10;
        }
        .fav-star.active { color: var(--gold); text-shadow: 0 0 10px var(--gold); }
        .fav-star:hover { transform: scale(1.2); }

        /* TOP BAR */
        .top-bar { display: flex; justify-content: space-between; align-items: center; padding: 15px 30px; background: rgba(0,0,0,0.95); border-bottom: 1px solid var(--primary); box-shadow: 0 5px 15px rgba(0,0,0,0.5); }
        .input-box { background: #000; border: 1px solid var(--primary); color: var(--primary); padding: 10px 15px; width: 300px; border-radius: 5px; outline: none; font-family: inherit; }
    </style>
</head>
<body>

    <div id="mainApp">
        <div class="top-bar">
            <div style="font-weight: bold; letter-spacing: 2px;">MONGLE_ARCADE <span style="font-size: 10px; color: #444;">v2.5.0</span></div>
            <div id="liveClock" style="color: var(--primary); font-size: 18px;">00:00:00</div>
            <input type="text" id="gameSearch" class="input-box" placeholder="SEARCH_DATABASE..." onkeyup="renderGames()">
        </div>
        <div class="grid" id="gameGrid"></div>
    </div>

    <script>
        let allGames = [];
        let favorites = JSON.parse(localStorage.getItem('mongle_favs')) || [];

        async function fetchGames() {
            try {
                const res = await fetch(`https://api.github.com/repos/bob154526-hue/Mongle/contents/`);
                const items = await res.json();
                // Filter for HTML files and ignore index
                allGames = items.filter(i => i.name.endsWith('.html') && i.name !== 'index.html');
                renderGames();
            } catch (e) {
                console.error("Critical: Database Unreachable.");
            }
        }

        window.toggleFav = (e, filename) => {
            e.stopPropagation(); // Prevents opening the game when clicking the star
            if (favorites.includes(filename)) {
                favorites = favorites.filter(f => f !== filename);
            } else {
                favorites.push(filename);
            }
            localStorage.setItem('mongle_favs', JSON.stringify(favorites));
            renderGames();
        };

        window.renderGames = () => {
            const query = document.getElementById('gameSearch').value.toLowerCase();
            const grid = document.getElementById('gameGrid');
            grid.innerHTML = "";

            const groups = {
                "â­ Favorites": [],
                "ðŸ» Freddy's Collection": [],
                "ðŸ•¹ï¸ All Games": []
            };
            
            allGames.forEach(game => {
                const filename = game.name;
                const name = filename.replace('.html', '').replace(/_/g, ' ');
                if (query && !name.toLowerCase().includes(query)) return;

                const isFav = favorites.includes(filename);
                const gameObj = {
                    name: name,
                    filename: filename,
                    isFav: isFav,
                    url: `https://raw.githack.com/bob154526-hue/Mongle/main/${filename}`,
                    icon: `https://raw.githubusercontent.com/bob154526-hue/Mongle/main/icons/${filename.replace('.html', '.png')}`
                };

                // Logic: 1. Favorites | 2. Freddy Group | 3. General
                const lowName = name.toLowerCase();
                const isFreddy = lowName.includes('freddy') || lowName.includes('fnaf') || lowName.includes('sister location') || lowName.includes('custom night') || lowName.includes('pizza simulator');

                if (isFav) {
                    groups["â­ Favorites"].push(gameObj);
                } else if (isFreddy) {
                    groups["ðŸ» Freddy's Collection"].push(gameObj);
                } else {
                    groups["ðŸ•¹ï¸ All Games"].push(gameObj);
                }
            });

            // Render categories
            for (const [title, games] of Object.entries(groups)) {
                if (games.length === 0) continue;
                
                const head = document.createElement('div');
                head.className = 'category-header';
                head.innerText = title;
                grid.appendChild(head);

                games.forEach(g => {
                    const card = document.createElement('div');
                    card.className = 'game-card';
                    card.innerHTML = `
                        <div class="fav-star ${g.isFav ? 'active' : ''}" onclick="toggleFav(event, '${g.filename}')">â˜…</div>
                        <img class="game-icon" src="${g.icon}" onerror="this.src='https://cdn-icons-png.flaticon.com/512/686/686588.png'">
                        <div style="font-size:13px; font-weight:bold; color:white;">${g.name}</div>
                    `;
                    card.onclick = () => window.open(g.url, '_blank');
                    grid.appendChild(card);
                });
            }
        };

        // Init
        fetchGames();
        setInterval(() => { document.getElementById('liveClock').innerText = new Date().toLocaleTimeString(); }, 1000);
    </script>
</body>
</html>
